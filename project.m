f1=500;
f2=1000;
f3=1500;
f4=2000;
fs=10*max([f1,f2,f3,f4]);
N=1000;
t=(0:1:(N-1))*(1/fs);
xt=cos(2*pi*f1*t)+cos(2*pi*f2*t)+cos(2*pi*f3*t)+cos(2*pi*f4*t);
figure;plot(t,xt);
audiowrite("xt.wav",xt,fs);
delta_f=fs/N;
f=(-(N/2):1:((N/2)-1))*delta_f;
Xf=fftshift(fft(xt,N))/fs;
A=1;
T=N/fs;
Xf1=Xf/(A*T);
figure;plot(f,abs(Xf1));
E_xt=sum(abs(xt).^2)*(1/fs);
disp(E_xt);
E_Xf=((1/(2*pi))*sum(abs(Xf).^2)*((2*pi*fs)/N));
disp(E_Xf);
pkg load signal;
[b,a]=butter(20,(1250/(fs/2)));
figure;freqz(b,a);
y1t=filter(b,a,xt);
audiowrite("y1t.wav",y1t,fs);
figure;plot(t,y1t);
Y1f=fftshift(fft(y1t,N))/fs;
Y1f1=Y1f/(A*T);
figure;plot(f,abs(Y1f1));
E_y1t=sum(abs(y1t).^2)*(1/fs);
disp(E_y1t);
E_Y1f=((1/(2*pi))*sum(abs(Y1f).^2)*((2*pi*fs)/N));
disp(E_Y1f);
[z,p,k]=butter(20,(1250/(fs/2)),'high');
sos = zp2sos(z,p,k);
y2t=sosfilt(sos,xt);
figure;plot(t,y2t);
Y2f=fftshift(fft(y2t,N))/fs;
Y2f1=Y2f/(A*T);
figure;plot(f,abs(Y2f1));
audiowrite("y2t.wav",y2t,fs);
E_y2t=sum(abs(y2t).^2)*(1/fs);
disp(E_y2t);
E_Y2f=((1/(2*pi))*sum(abs(Y2f).^2)*((2*pi*fs)/N));
disp(E_Y2f);